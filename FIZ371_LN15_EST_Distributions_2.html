
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Distributions 2 : Continous Distributions &#8212; FIZ371 - Scientific and Technical Computations Lecture Notes</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Game Theory" href="FIZ371_LN25_EST_Game_Theory.html" />
    <link rel="prev" title="Distributions 1 : Discrete Distributions" href="FIZ371_LN10_EST_Distributions_1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FIZ371 - Scientific and Technical Computations Lecture Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Cover.html">
   FIZ371 - Scientific and Technical Calculations
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="FIZ371_LectureNotes.html">
   Lecture Notes
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN01_EST_Probabilities_Theory.html">
     Probabilities - Concept &amp; Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN01_EST_Probabilities_Theory_Application_WOZ.html">
     Probabilities Application: Letter Frequencies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN02_EST_Probabilities.html">
     Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN08_EST_Application_Monty_Hall.html">
     Monty Hall Problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="WhiteTokenOutOf2.html">
     Application White Token Out Of 2 Bags
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN06_SixSwitchPuzzle_and_Parallelization.html">
     Six Switch Puzzle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN10_EST_Distributions_1.html">
     Discrete Distributions
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Distributions 2 : Continous Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN25_EST_Game_Theory.html">
     Game Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN28_EST_Game_Theory_PrisonnersDilemmaWithMemory.html">
     Application Prisonner's Dilemma (with Memory)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="GaleShapleyMatching_Implementation.html">
     Gale-Shapley Algorithm Implementation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN36_EST_Information_Theory.html">
     Information Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN36_EST_Information_Theory_MessageTransmissionOverNoise.html">
     Information Theory Application
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN47_EST_CellularAutomata_GameOfLife.html">
     Cellular Automata
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN80_EST_2DIsing.html">
     2D Ising Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="FIZ371_LN69_EST_NeuralNetworks.html">
     Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MinimizeOptimizeFit.html">
     Optimization, Minimization &amp; Fitting Notes &amp; Recipes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="FIZ371_ExercisesExams.html">
   Exercises &amp; Exams
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Exams_HW/FIZ371_20221_MT.html">
     2022-23 Fall Term Midterm Exam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Exams_HW/FIZ371_20221_Final.html">
     2022-23 Fall Term Final Exam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Exams_HW/FIZ371_20221_Resit.html">
     2022-23 Fall Term Resit Exam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Exams_HW/FIZ371_20231_MT.html">
     2023-24 Fall Term Midterm Exam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Exams_HW/FIZ371_20231_MT_MakeUp.html">
     2023-24 Fall Term Midterm MakeUp Exam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Exams_HW/FIZ371_20231_Final.html">
     2023-24 Fall Term Final Exam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Exams_HW/FIZ371_20231_Final_Resit.html">
     2023-24 Fall Term Resit Exam
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/FIZ371_LN15_EST_Distributions_2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/FIZ371_LN15_EST_Distributions_2.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/emresururi/FIZ228/master?urlpath=tree/FIZ371_LN15_EST_Distributions_2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Distributions 2 : Continous Distributions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reprise-galton-machine">
   Reprise: Galton Machine
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian-normal-distribution">
   Gaussian (Normal) Distribution
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-and-standard-variance-of-the-binomial-distribution-or-is-it-the-normal-distribution">
   Mean and standard variance of the binomial distribution (or is it the normal distribution?.. ;)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-value-mu">
     Mean Value (
     <span class="math notranslate nohighlight">
      \(\mu\)
     </span>
     )
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standard-variation-sigma">
     Standard variation (
     <span class="math notranslate nohighlight">
      \(\sigma\)
     </span>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian-distribution-final-form">
   Gaussian distribution, final form
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application-the-six-sigma">
   Application: The Six
   <span class="math notranslate nohighlight">
    \(\sigma\)
   </span>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-code-of-our-own-deriving-the-sigma-distribution-ratios-stochastically">
   A code of our own: Deriving the
   <span class="math notranslate nohighlight">
    \(\sigma\)
   </span>
   distribution ratios stochastically
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#poisson-distribution">
   Poisson Distribution
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assignment-hw-mean-and-variance-of-poisson-distribution">
     Assignment / HW : mean and variance of Poisson distribution
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-airplane-accidents">
     Example: Airplane accidents
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Distributions 2 : Continous Distributions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Distributions 2 : Continous Distributions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reprise-galton-machine">
   Reprise: Galton Machine
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian-normal-distribution">
   Gaussian (Normal) Distribution
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-and-standard-variance-of-the-binomial-distribution-or-is-it-the-normal-distribution">
   Mean and standard variance of the binomial distribution (or is it the normal distribution?.. ;)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-value-mu">
     Mean Value (
     <span class="math notranslate nohighlight">
      \(\mu\)
     </span>
     )
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standard-variation-sigma">
     Standard variation (
     <span class="math notranslate nohighlight">
      \(\sigma\)
     </span>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian-distribution-final-form">
   Gaussian distribution, final form
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application-the-six-sigma">
   Application: The Six
   <span class="math notranslate nohighlight">
    \(\sigma\)
   </span>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-code-of-our-own-deriving-the-sigma-distribution-ratios-stochastically">
   A code of our own: Deriving the
   <span class="math notranslate nohighlight">
    \(\sigma\)
   </span>
   distribution ratios stochastically
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#poisson-distribution">
   Poisson Distribution
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assignment-hw-mean-and-variance-of-poisson-distribution">
     Assignment / HW : mean and variance of Poisson distribution
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-airplane-accidents">
     Example: Airplane accidents
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="distributions-2-continous-distributions">
<h1>Distributions 2 : Continous Distributions<a class="headerlink" href="#distributions-2-continous-distributions" title="Permalink to this headline">¶</a></h1>
<p><strong>FIZ371 - Scientific &amp; Technical Computations | 06/04/2020</strong></p>
<p><strong>Continous Distributions</strong></p>
<ul class="simple">
<li><p>Reprise: Galton Machine</p></li>
<li><p>Gaussian (Normal) Distribution</p>
<ul>
<li><p>Mean and standard variance of the binomial distribution (or is it the normal distribution?.. ;)</p>
<ul>
<li><p>Mean Value (μ)</p></li>
<li><p>Standard variation (σ)</p></li>
</ul>
</li>
<li><p>Gaussian distribution, final form</p></li>
<li><p>Application: The Six σ</p></li>
<li><p>A code of our own: Deriving the  σσ  distribution ratios stochastically</p></li>
</ul>
</li>
<li><p>Poisson Distribution</p>
<ul>
<li><p>Assignment / HW : mean and variance of Poisson distribution</p></li>
<li><p>Example: Airplane accidents</p></li>
</ul>
</li>
</ul>
<p>Emre S. Tasci <a class="reference external" href="mailto:emre&#46;tasci&#37;&#52;&#48;hacettepe&#46;edu&#46;tr">mailto:emre<span>&#46;</span>tasci<span>&#64;</span>hacettepe<span>&#46;</span>edu<span>&#46;</span>tr</a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="reprise-galton-machine">
<h1>Reprise: Galton Machine<a class="headerlink" href="#reprise-galton-machine" title="Permalink to this headline">¶</a></h1>
<p>In our <a class="reference internal" href="FIZ371_LN10_EST_Distributions_1.html"><span class="doc std std-doc">previous lecture</span></a>, we defined and analyzed the Galton machine and also implemented a simulator for it. That code is reproduced below, this time functionalized with the number of levels &amp; balls as its input parameters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">Galton</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="c1"># Fixing the seed so that the results are repeatable</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">371</span><span class="p">)</span>

    <span class="c1"># n: Number of levels</span>
    <span class="c1"># N: Number of balls</span>

    <span class="c1"># Initialize the boxes (numbered from 0 to n)</span>
    <span class="n">arr_boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Loop over the balls</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
        <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1"># print(direction,end=&quot; &quot;)</span>
            <span class="n">position</span> <span class="o">+=</span> <span class="n">direction</span>

        <span class="c1"># if it goes left everytime, then the position</span>
        <span class="c1"># would be: 0 which is the leftmost box: 0</span>

        <span class="c1"># if it goes right everytime, then the position</span>
        <span class="c1"># would be: +n which is the rightmost box: #n</span>
        <span class="c1"># print(str(position))</span>
        <span class="n">arr_boxes</span><span class="p">[</span><span class="n">position</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1">#d#print(&quot;Simulation results:&quot;)</span>
    <span class="c1">#d#print(arr_boxes/N)</span>

    <span class="c1">#d#print(&quot;&quot;)</span>

    <span class="c1"># Let&#39;s compare it with the direct Pascal&#39;s triangle results:</span>
    <span class="n">pascal_triangle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">pascal_triangle</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">kk</span><span class="p">)</span>
    <span class="c1">#print(pascal_triangle)</span>
    <span class="n">pascal_triangle</span> <span class="o">=</span> <span class="n">pascal_triangle</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pascal_triangle</span><span class="p">)</span>
    <span class="c1">#d#print(&quot;Pascal&#39;s Triangle:&quot;)</span>
    <span class="c1">#d#print(pascal_triangle)</span>

    <span class="c1"># While we&#39;re at it, let&#39;s also plot the probabilities by</span>
    <span class="c1"># dividing the number of balls in each box to the tall # of balls:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">arr_boxes</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>

    <span class="c1"># and project upon it the values from Pascal&#39;s triangle:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">pascal_triangle</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    
    <span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr_boxes</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">std</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr_boxes</span><span class="o">/</span><span class="n">N</span><span class="p">,(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n:</span><span class="si">%3d</span><span class="s2"> Levels | N:</span><span class="si">%d</span><span class="s2"> Balls&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mean: </span><span class="si">%.5f</span><span class="s2"> | std dev: </span><span class="si">%.5f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">std</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">mu</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">std</span><span class="p">,</span><span class="n">mu</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;n:</span><span class="si">%3d</span><span class="s2"> Levels | N:</span><span class="si">%d</span><span class="s2"> Balls&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">arr_boxes</span><span class="o">/</span><span class="n">N</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># So we can call it now like:</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">Galton</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------
n:  4 Levels | N:10000 Balls
mean: 1.99480 | std dev: 0.99638
</pre></div>
</div>
<img alt="_images/FIZ371_LN15_EST_Distributions_2_3_1.png" src="_images/FIZ371_LN15_EST_Distributions_2_3_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.061  0.2525 0.3807 0.2423 0.0635]
</pre></div>
</div>
</div>
</div>
<p>This time, we’re going to increase the number of levels (and also to have statistically meaningful results, we will ensure that there is a sufficient number of balls to accompany them 8).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#for i in np.array([10,25,50,100,250,500,1000]):</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">250</span><span class="p">]):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">n</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">Galton</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------
n: 10 Levels | N:1000 Balls
mean: 5.01900 | std dev: 1.58134
</pre></div>
</div>
<img alt="_images/FIZ371_LN15_EST_Distributions_2_5_1.png" src="_images/FIZ371_LN15_EST_Distributions_2_5_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------
n: 25 Levels | N:2500 Balls
mean: 12.44880 | std dev: 2.46661
</pre></div>
</div>
<img alt="_images/FIZ371_LN15_EST_Distributions_2_5_3.png" src="_images/FIZ371_LN15_EST_Distributions_2_5_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------
n: 50 Levels | N:5000 Balls
mean: 24.88080 | std dev: 3.53579
</pre></div>
</div>
<img alt="_images/FIZ371_LN15_EST_Distributions_2_5_5.png" src="_images/FIZ371_LN15_EST_Distributions_2_5_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------
n:100 Levels | N:10000 Balls
mean: 49.89790 | std dev: 4.96444
</pre></div>
</div>
<img alt="_images/FIZ371_LN15_EST_Distributions_2_5_7.png" src="_images/FIZ371_LN15_EST_Distributions_2_5_7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------
n:250 Levels | N:25000 Balls
mean: 124.97924 | std dev: 7.93965
</pre></div>
</div>
<img alt="_images/FIZ371_LN15_EST_Distributions_2_5_9.png" src="_images/FIZ371_LN15_EST_Distributions_2_5_9.png" />
</div>
</div>
<p>So, you can see that, as the number of levels increase, naturally the number of “boxes” also increase and a pattern emerges. The “thickness” of the boxes becomes thinner, as we “zoom out” to fit more and more boxes in our graph and the overall distribution looks like a symmetrical “bell” centered on the middle box.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="gaussian-normal-distribution">
<h1>Gaussian (Normal) Distribution<a class="headerlink" href="#gaussian-normal-distribution" title="Permalink to this headline">¶</a></h1>
<p>This bell-like shaped curve has its very special place in statistics and in nature: it is called a Gaussian curve and <a class="reference external" href="http://scipp.ucsc.edu/~haber/ph116C/NormalApprox.pdf">we are going to derive the fact</a> that as <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span>, binomial distribution becomes Gaussian distribution, just as the graphs above suggest. This distribution occurs so frequently that, it is also called the “normal” distribution.</p>
<p>Remember that, the probability of the chosen outcome happening <span class="math notranslate nohighlight">\(k\)</span> times out of <span class="math notranslate nohighlight">\(n\)</span> tries was given by the binomial probability distribution function as:</p>
<div class="math notranslate nohighlight">
\[P(n,k)
=\frac{n!}{k!\left(n-k\right)!}\,p^k\, \left(1-p\right)^{n-k}\]</div>
<p>where <span class="math notranslate nohighlight">\(p\)</span> being the probability of the chosen outcome happening in a single try (and thus <span class="math notranslate nohighlight">\((1-p)\)</span> corresponding to the probability of the chosen outcome <em>not</em> happening).</p>
<p>For the sake of practicality (and taking the next step to continous distribution in the case of: <span class="math notranslate nohighlight">\(k\rightarrow x\)</span>), we will switch to different symbols in the proof:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> will replace <span class="math notranslate nohighlight">\(k\)</span></p></li>
<li><p>we will denote <span class="math notranslate nohighlight">\((1-p)\)</span> by <span class="math notranslate nohighlight">\(q\)</span>
so, our PDF above will be re-written as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[P(x) = \frac{n!}{x!\left(n-x\right)!}\,p^x\, q^{n-x}\]</div>
<p>We will be working in the <span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span> limit, justifying the approximations.</p>
<p>To get rid of the factorials, we will use <a class="reference external" href="https://en.wikipedia.org/wiki/Stirling%27s_approximation">Stirling’s approximation</a>:</p>
<div class="math notranslate nohighlight">
\[n! \approx n^n e^{-n} \sqrt{2\pi n}\]</div>
<p>Substitution of all the factorials yields:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
P(x) &amp;= \frac{n^n e^{-n} \sqrt{2\pi n}}{\left[x^x e^{-x} \sqrt{2\pi x}\right]
\left[(n-x)^{n-x} e^{-(n-x)}\sqrt{2 \pi (n-x)}\right]
}p^x q^{n-x}\\
&amp;=(p\,/x)^x (q\,/(n-x))^{n-x} n^n \sqrt{\frac{n}{2\pi x (n-x)}}\\
&amp;=\left(\frac{np}{x}\right)^x\left(\frac{nq}{n-x}\right)^{n-x} \sqrt{\frac{n}{2\pi x (n-x)}}
\end{align*}\end{split}\]</div>
<p>If we define: <span class="math notranslate nohighlight">\(\delta = x - np\)</span>, then <span class="math notranslate nohighlight">\(x=\delta+np\)</span> and <span class="math notranslate nohighlight">\(n-x = nq-\delta\)</span>.</p>
<p>From here we can write:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\ln\left(\frac{np}{x}\right) &amp;= \ln\left(\frac{np}{np+\delta}\right) = -\ln\left(1 + \frac{\delta}{np}\right)\\
\ln\left(\frac{nq}{n-x}\right) &amp;= \ln\left(\frac{nq}{nq-\delta}\right) = -\ln\left(1 - \frac{\delta}{nq}\right)
\end{align*}\end{split}\]</div>
<p>At this point we’ll take the logarithm of the probability function’s <span class="math notranslate nohighlight">\(\left(\frac{np}{x}\right)^x\left(\frac{nq}{n-x}\right)^{n-x}\)</span> part:</p>
<div class="math notranslate nohighlight">
\[\ln\left[\left(\frac{np}{x}\right)^x\left(\frac{nq}{n-x}\right)^{n-x}\right] = x\ln\left(\frac{np}{x}\right)+(n-x) \ln\left(\frac{nq}{n-x}\right)\]</div>
<p>Substitute <span class="math notranslate nohighlight">\(x=\delta+np\)</span>, <span class="math notranslate nohighlight">\(n-x = nq-\delta\)</span>, the above logarithmic identities, and use the expansion:</p>
<div class="math notranslate nohighlight">
\[\ln(1+x) = x - \frac{1}{2} x^2\]</div>
<p>to have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\ln\left[\left(\frac{np}{x}\right)^x\left(\frac{nq}{n-x}\right)^{n-x}\right] &amp;= x\ln\left(\frac{np}{x}\right)+(n-x) \ln\left(\frac{nq}{n-x}\right)\\
&amp;=-(\delta+np)\left[\frac{\delta}{np}-\frac{1}{2}\frac{\delta^2}{n^2 p^2}\right] - (nq-\delta)\left[-\frac{\delta}{nq} -\frac{1}{2} \frac{\delta^2}{n^2 q^2} \right]\\
&amp;=-\delta\left[1 + \frac{1}{2} \frac{\delta}{np} -1 + + \frac{1}{2} \frac{\delta}{nq}\right]\\
&amp;=-\frac{\delta^2}{2n p q}
\end{align*}\end{split}\]</div>
<p>(we have also used the <span class="math notranslate nohighlight">\(p+q=1\)</span> identity)</p>
<p>We are almost there… We exponentiate the above equation to retrieve <span class="math notranslate nohighlight">\(\left(\frac{np}{x}\right)^x\left(\frac{nq}{n-x}\right)^{n-x}\)</span> in the original function:</p>
<div class="math notranslate nohighlight">
\[\rightarrow \left(\frac{np}{x}\right)^x\left(\frac{nq}{n-x}\right)^{n-x} = e^{-\delta^2/2npq} = e^{-(x-np)^2/2npq}\]</div>
<p>The square root factor still remains, so let’s work on it a little:</p>
<div class="math notranslate nohighlight">
\[\sqrt{\frac{n}{2\pi x (n-x)}} = \sqrt{\frac{n}{2\pi (np+\delta) (nq-\delta)}} = \sqrt{\frac{1}{2\pi npq}} = \frac{1}{\sqrt{2\pi npq}}\]</div>
<p>Combining all, we have:</p>
<div class="math notranslate nohighlight">
\[P(x) =  \frac{1}{\sqrt{2\pi npq}} e^{-(x-np)^2/2npq}\]</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mean-and-standard-variance-of-the-binomial-distribution-or-is-it-the-normal-distribution">
<h1>Mean and standard variance of the binomial distribution (or is it the normal distribution?.. ;)<a class="headerlink" href="#mean-and-standard-variance-of-the-binomial-distribution-or-is-it-the-normal-distribution" title="Permalink to this headline">¶</a></h1>
<section id="mean-value-mu">
<h2>Mean Value (<span class="math notranslate nohighlight">\(\mu\)</span>)<a class="headerlink" href="#mean-value-mu" title="Permalink to this headline">¶</a></h2>
<p>(Once again, we are using <a class="reference external" href="http://scipp.ucsc.edu/~haber/ph116C/NormalApprox.pdf">Howard Haber’s Physics 116 page</a> for this section, as well)</p>
<p>We start from the binomial distribution:</p>
<div class="math notranslate nohighlight">
\[P(n,k) = C(n,k)\,p^k\, q^{n-k}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[C(n,k) \equiv \frac{n!}{k!\left(n-k\right)!}\]</div>
<p>as we have seen in the course on the binomial distribution. <span class="math notranslate nohighlight">\(p\)</span> is the probability that the outcome will be success and <span class="math notranslate nohighlight">\(q\)</span> is the probability that it will be failure, thus <span class="math notranslate nohighlight">\(q = 1-p\)</span>.</p>
<p>As is usual with statistics, we’ll start pursuing a seemingly not related identity (“let’s begin by taking…”) and then in the end find out that it becomes a very practical solution to our needs.</p>
<p>So, <em>let’s begin by taking</em> the expansion of <span class="math notranslate nohighlight">\((p+q)^n\)</span>:</p>
<div class="math notranslate nohighlight">
\[(p+q)^n = \sum_{k=0}^{n}{C(n,k)\,p^k q^{n-k}}\]</div>
<p>Check that this is just the binomial expansion, nothing fancy than for example: <span class="math notranslate nohighlight">\((a+b)^2 = a^2 + 2ab + b^2\)</span> or <span class="math notranslate nohighlight">\((a+b)^3 = a^3 + 3a^2 b + 3a b^2 + b^3\)</span>, with the <span class="math notranslate nohighlight">\(C(n,k)\)</span> coefficients being the coefficients of the Pascal’s triangle. So it holds for <strong>any</strong> <span class="math notranslate nohighlight">\(a,b\)</span> – not just <span class="math notranslate nohighlight">\(p,q\)</span> with <span class="math notranslate nohighlight">\(p+q=1\)</span> (but we’ll also exploit this fact later as well! 8)</p>
<p>Now, <em>for some reason</em>, we undergo an irrestible sensation that we have to take the equation’s derivative with respect to <span class="math notranslate nohighlight">\(p\)</span> and further multiply it by <span class="math notranslate nohighlight">\(p\)</span>, to obtain:</p>
<div class="math notranslate nohighlight">
\[\begin{split}p \frac{d}{dp}\left[(p+q)^n = \sum_{k=0}^{n}{C(n,k)\,p^k q^{n-k}}\right]\\
p \frac{d}{dp} (p+q)^n = p\sum_{k=0}^{n}{k C(n,k)\,p^{k-1} q^{n-k}}=\sum_{k=0}^{n}{k C(n,k)\,p^{k} q^{n-k}}\\
np (p+q)^{n-1} = \sum_{k=0}^{n}{k C(n,k)\,p^{k} q^{n-k}}\end{split}\]</div>
<p>In the second row, we applied the <span class="math notranslate nohighlight">\(p\)</span> times derivation to the right side, and the in the third row, we applied it to the left side. As we have written above, this equation is valid for any <span class="math notranslate nohighlight">\(p,q\)</span>. But we’ll now take into account that, as <span class="math notranslate nohighlight">\(p+q=1\)</span> through our definition of them as being the probabilities of one of the only two possible outcomes (“binom” – remember?), so it becomes:</p>
<div class="math notranslate nohighlight">
\[np=\sum_{k=0}^{n}{k P(k)}\]</div>
<p>Which is the mean value of the distribution by definition (“summing up the possible values multiplied by their probability”), so:</p>
<div class="math notranslate nohighlight">
\[\mu = &lt;k&gt; = \bar{k} = np\]</div>
<p><em>In the limit <span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span>, discrete <span class="math notranslate nohighlight">\(k\)</span> values becomes continous <span class="math notranslate nohighlight">\(x\)</span> values</em></p>
</section>
<section id="standard-variation-sigma">
<h2>Standard variation (<span class="math notranslate nohighlight">\(\sigma\)</span>)<a class="headerlink" href="#standard-variation-sigma" title="Permalink to this headline">¶</a></h2>
<p>We follow a similar path for the calculation of the variance and standard variation. In this case we take:</p>
<div class="math notranslate nohighlight">
\[\begin{split}p^2 \frac{d^2}{dp^2}\left[(p+q)^n = \sum_{k=0}^{n}{C(n,k)\,p^k q^{n-k}}\right]\\
n (n-1)p^2(p+q)^{n-2} = \sum_{k=0}^{n}{k (k-1) C(n,k)\,p^{k} q^{n-k}}\end{split}\]</div>
<p>Once again, the above equation will hold for any <span class="math notranslate nohighlight">\(p,q\)</span>, but further  applying the relation of <span class="math notranslate nohighlight">\(p+q=1\)</span>, we get:</p>
<div class="math notranslate nohighlight">
\[n (n-1)p^2 = \sum_{k=0}^{n}{k^2 P(k)} - \sum_{k=0}^{n}{k^ P(k)}\]</div>
<p>From the definition of mean, we can equate the right side to <span class="math notranslate nohighlight">\(\overline{x^2}\)</span> and <span class="math notranslate nohighlight">\({\overline{x}}\)</span>, respectively, so:</p>
<div class="math notranslate nohighlight">
\[\overline{x^2} = n (n-1)p^2 + np\]</div>
<p>Hence, the variance and the standard variation turns out to be:</p>
<div class="math notranslate nohighlight">
\[\sigma^2 = \overline{x^2} - {\overline{x}}^2 = n(n-1)p^2+np-n^2 p^2 = np (1 - p)\]</div>
<p>Substituting <span class="math notranslate nohighlight">\(q = (1-p)\)</span>, we finally arrive at:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\sigma^2 = npq\\
\sigma = \sqrt{npq}\end{split}\]</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="gaussian-distribution-final-form">
<h1>Gaussian distribution, final form<a class="headerlink" href="#gaussian-distribution-final-form" title="Permalink to this headline">¶</a></h1>
<p>Checking out the derived distribution by taking <span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span> and thus allowing many possible <span class="math notranslate nohighlight">\(k\)</span> values such that we switch from discrete <span class="math notranslate nohighlight">\(k\)</span> values to <em>continous</em> <span class="math notranslate nohighlight">\(x\)</span> values, we have:</p>
<div class="math notranslate nohighlight">
\[P(x) =  \frac{1}{\sqrt{2\pi npq}} e^{-(x-np)^2/2npq}\]</div>
<p>Lo and behold! We see that there are <span class="math notranslate nohighlight">\(npq\)</span>s and <span class="math notranslate nohighlight">\(np\)</span> lying around!!! We’ve already derived that the mean <span class="math notranslate nohighlight">\(\mu = np\)</span> and the variance <span class="math notranslate nohighlight">\(\sigma^2 = npq\)</span>, so let’s substitute them in the equation and we’ll have:</p>
<div class="math notranslate nohighlight">
\[P(x) =  \frac{1}{\sqrt{2\pi}\sigma} e^{-(x-\mu)^2/2\sigma^2}\]</div>
<p>We have seen that <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> are the mean and standard deviations, and in addition, they are the two characteristic parameters that define a Gaussian distribution. <span class="math notranslate nohighlight">\(\mu\)</span> defines the location for the symmetry axis and <span class="math notranslate nohighlight">\(\sigma\)</span> determines the “wideness” or, the “extensiveness” of our distribution. As the total integral from <span class="math notranslate nohighlight">\(x=-\infty\)</span> to <span class="math notranslate nohighlight">\(x=\infty\)</span> must be equal to 1 (meaning that, the total probability that any one of the possible outcomes will be (will be, que sera, sera… 8)), for higher number of <span class="math notranslate nohighlight">\(\sigma\)</span>, our distribution must <em>distribute</em> itself to a wider range, thus lowering its maximum probabilities’ values.</p>
<p>Here are a couple of Gaussian distributions for a variety of <span class="math notranslate nohighlight">\((\mu,\sigma)\)</span> values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># Our reference distribution with mu = 5, sigma=1</span>
<span class="n">g_5_1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Same mean, different sigma</span>
<span class="n">g_5_2p5</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Same mean, different sigma&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g_5_1</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">g_5_1</span><span class="p">)],</span><span class="s2">&quot;r--&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g_5_2p5</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">g_5_2p5</span><span class="p">)],</span><span class="s2">&quot;r--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g_5_1</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">g_5_2p5</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">g_5_1</span><span class="p">)],</span><span class="s2">&quot;r--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ----------------------------------</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Different mean, same sigma</span>
<span class="n">g_7_1</span> <span class="o">=</span>  <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Different mean, same sigma&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g_5_1</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">g_5_1</span><span class="p">)],</span><span class="s2">&quot;r--&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g_7_1</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">g_7_1</span><span class="p">)],</span><span class="s2">&quot;r--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g_5_1</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">g_7_1</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">g_5_1</span><span class="p">)],</span>\
         <span class="s2">&quot;r--&quot;</span><span class="p">,[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">g_7_1</span><span class="p">)],</span><span class="s2">&quot;r--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/FIZ371_LN15_EST_Distributions_2_17_0.png" src="_images/FIZ371_LN15_EST_Distributions_2_17_0.png" />
<img alt="_images/FIZ371_LN15_EST_Distributions_2_17_1.png" src="_images/FIZ371_LN15_EST_Distributions_2_17_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------
</pre></div>
</div>
<img alt="_images/FIZ371_LN15_EST_Distributions_2_17_3.png" src="_images/FIZ371_LN15_EST_Distributions_2_17_3.png" />
<img alt="_images/FIZ371_LN15_EST_Distributions_2_17_4.png" src="_images/FIZ371_LN15_EST_Distributions_2_17_4.png" />
</div>
</div>
<p>Let’s find out the value of a distribution when it’s <span class="math notranslate nohighlight">\(\sigma\)</span> away from the mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># Our reference distribution with mu = 5, sigma=1</span>
<span class="n">g_5_1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P(x|5,1): Max probability (at x = mu = 5, of course)  : </span><span class="si">%.5f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">norm</span>.pdf(5,loc=5,scale=1))
<span class="n">g_5_1_sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P(x|5,1): Probability at x = mu &quot;</span><span class="o">+</span><span class="sa">u</span><span class="s2">&quot;</span><span class="se">\u00B1</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot; sigma : </span><span class="si">%.5f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">norm</span>.pdf(5-1,loc=5,scale=1))
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ratio of P(x=mu)/P(x=mu&quot;</span><span class="o">+</span><span class="sa">u</span><span class="s2">&quot;</span><span class="se">\u00B1</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;sigma): </span><span class="si">%.15f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Same mean, different sigma</span>
<span class="n">g_5_2p5</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P(x|5,2.5): Max probability (at x = mu = 5, of course): </span><span class="si">%.5f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">norm</span>.pdf(5,loc=5,scale=2.5))
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P(x|5,2.5): Probability at x = mu &quot;</span><span class="o">+</span><span class="sa">u</span><span class="s2">&quot;</span><span class="se">\u00B1</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot; sigma : </span><span class="si">%.5f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">norm</span>.pdf(5-2.5,loc=5,scale=2.5))
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ratio of P(x=mu)/P(x=mu&quot;</span><span class="o">+</span><span class="sa">u</span><span class="s2">&quot;</span><span class="se">\u00B1</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;sigma): </span><span class="si">%.15f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(x|5,1): Max probability (at x = mu = 5, of course)  : 0.39894
P(x|5,1): Probability at x = mu ± sigma : 0.24197
Ratio of P(x=mu)/P(x=mu±sigma): 1.648721270700128
---------------------------------------------
P(x|5,2.5): Max probability (at x = mu = 5, of course): 0.15958
P(x|5,2.5): Probability at x = mu ± sigma : 0.09679
Ratio of P(x=mu)/P(x=mu±sigma): 1.648721270700128
</pre></div>
</div>
</div>
</div>
<p>So, the standard deviation has the property such that when you travel sigma away from the mean value, the probability decreases “1.648721270700128”th of the maximum value.</p>
<p><em>Does</em> <u>1.648721270700128</u> <em>seem familiar?</em> No?.. Then how about:</p>
<p><code class="docutils literal notranslate"><span class="pre">2.718281828459045</span></code></p>
<p>Yes, that’s the most famous <a class="reference external" href="https://en.wikipedia.org/wiki/E_(mathematical_constant)">Euler’s number</a>, <em>e</em> (as in <span class="math notranslate nohighlight">\(\exp\)</span>). Let’s take its root:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;     e  = </span><span class="si">%.15f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">np</span>.exp(1))
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sqrt(e) = </span><span class="si">%.15f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">np</span>.exp(0.5))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     e  = 2.718281828459045
sqrt(e) = 1.648721270700128
</pre></div>
</div>
</div>
</div>
<p><img alt="JamesHence_Beaker_Scream.jpg" src="_images/JamesHence_Beaker_Scream.jpg" />
(James Hence - “The Meep”)</p>
<p><img alt="mindblown.jpg" src="_images/mindblown.jpg" />
<a class="reference external" href="https://www.youtube.com/watch?v=9CS7j5I6aOc">Mindblown!!!</a></p>
<p>So, for a Gaussian distribution, we can alternatively define the standard deviation as the distance from the mean where the probability decreases to <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{e}}\)</span> of its maximum value.</p>
<p><strong>Duh?…</strong></p>
<p>Let’s proceed from math’s point of view, using the Gaussian distribution formula:</p>
<div class="math notranslate nohighlight">
\[P(x) =  \frac{1}{\sqrt{2\pi}\sigma} e^{-(x-\mu)^2/2\sigma^2}\]</div>
<p>at <span class="math notranslate nohighlight">\(x = \mu\)</span>, this becomes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
P(\mu) &amp;=  \frac{1}{\sqrt{2\pi}\sigma} e^{-(\mu-\mu)^2/2\sigma^2}\\
&amp;=\frac{1}{\sqrt{2\pi}\sigma} e^{0}\\
&amp;=\frac{1}{\sqrt{2\pi}\sigma}
\end{align*}\end{split}\]</div>
<p>What about the probability when <span class="math notranslate nohighlight">\(x = \mu\pm\sigma\)</span>?</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
P(\mu\pm\sigma) &amp;=  \frac{1}{\sqrt{2\pi}\sigma} e^{-(\mu\pm\sigma-\mu)^2/2\sigma^2}\\
&amp;=\frac{1}{\sqrt{2\pi}\sigma}e^{-\sigma^2/2\sigma^2} =\frac{1}{\sqrt{2\pi}\sigma}e^{-1/2}\\
&amp;=\frac{1}{\sqrt{2\pi}\sigma}\frac{1}{\sqrt{e}}
\end{align*}\end{split}\]</div>
<p>Thus:</p>
<div class="math notranslate nohighlight">
\[\frac{P(\mu)}{P(\mu\pm\sigma)} = \frac{\frac{1}{\sqrt{2\pi}\sigma}}{\frac{1}{\sqrt{2\pi}\sigma}\frac{1}{\sqrt{e}}}=\sqrt{e}\]</div>
<p>Now it doesn’t seem to be so mindblowing but just a boring (and an obvious) derivation… but remember, this is <em>just</em> maths. We will be doing physics and modeling, so it’s more important to pay attention to the <u>meaning</u> of the <span class="math notranslate nohighlight">\(\sigma\)</span> than what it does on a dull mathematical formula (it’s similar to the information transferred by saying “the magnitude of the space a circle covers is equal to <span class="math notranslate nohighlight">\(\pi r^2\)</span>” than simply writing a general and vague math equation of <span class="math notranslate nohighlight">\(\pi r^2\)</span> which can mean anything and nothing).</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="application-the-six-sigma">
<h1>Application: The Six <span class="math notranslate nohighlight">\(\sigma\)</span><a class="headerlink" href="#application-the-six-sigma" title="Permalink to this headline">¶</a></h1>
<p>I recommend you to stop reading at this instant and google for “<a class="reference external" href="https://www.google.com/search?q=the+six+sigma&amp;oq=the+six+sigma&amp;hl=en">the six sigma</a>”. Most of the results you are going to fine will be <strike>stupid</strike> self-pompitous “excel yourself, reach the skies bla bla…” junk sites but their root lies on pure statistics. Here is how.</p>
<p>So, let’s start once again with a nice Gaussian distribution characterized by <span class="math notranslate nohighlight">\(\mu = 5\)</span> &amp; <span class="math notranslate nohighlight">\(\sigma = 2.5\)</span> <span class="math notranslate nohighlight">\(\Rightarrow P(x|\mu=5,\sigma=2.5)\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># Our reference distribution with mu = 5, sigma=1</span>
<span class="n">g_5_2p5</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g_5_2p5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/FIZ371_LN15_EST_Distributions_2_26_0.png" src="_images/FIZ371_LN15_EST_Distributions_2_26_0.png" />
</div>
</div>
<p>Since our distribution is normalized, when we calculate the integral:</p>
<div class="math notranslate nohighlight">
\[I=\int_{-\infty}^{\infty}{P(x|\mu=5,\sigma=2.5)\, dx}\]</div>
<p>we expect to find 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>

<span class="n">G</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="p">[</span><span class="n">I</span><span class="p">,</span><span class="n">err</span><span class="p">]</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I = </span><span class="si">%.5f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">I</span>)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>I = 1.00000
</pre></div>
</div>
</div>
</div>
<p>This time, let’s gradually integrate our distribution [from <span class="math notranslate nohighlight">\((\mu - n\cdot\sigma)\)</span> to <span class="math notranslate nohighlight">\(\left(\mu - \left(n-1\right)\cdot\sigma\right)
\)</span>] + [from <span class="math notranslate nohighlight">\(\left(\mu + \left(n-1\right)\cdot\sigma\right)\)</span> to <span class="math notranslate nohighlight">\((\mu + n\cdot\sigma)\)</span>] with <span class="math notranslate nohighlight">\(n = 1\dotsc7\)</span>, i.e.,</p>
<div class="math notranslate nohighlight">
\[\int_{\mu-n\sigma}^{\mu-(n-1)\sigma}{P(x|\mu,\sigma)\, dx} + \int_{\mu+(n-1)\sigma}^{\mu+n\sigma}{P(x|\mu,\sigma)\, dx}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>

<span class="n">mean</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">G</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="n">I_tot</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span>
    <span class="p">[</span><span class="n">I</span><span class="p">,</span><span class="n">err</span><span class="p">]</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">mean</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span><span class="n">mean</span><span class="o">-</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span>
    <span class="n">I_tot</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n:</span><span class="si">%d</span><span class="s2"> - Range: [μ-</span><span class="si">%d</span><span class="s2">σ,μ] U [μ,μ+</span><span class="si">%d</span><span class="s2">σ]</span><span class="se">\n</span><span class="s2"> --&gt; I U I = 2*</span><span class="si">%.10f</span><span class="s2"> = </span><span class="si">%.10f</span><span class="s2"> (I_Tot = </span><span class="si">%.15f</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">,</span><span class="n">I_tot</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n:1 - Range: [μ-1σ,μ] U [μ,μ+1σ]
 --&gt; I U I = 2*0.3413447461 = 0.6826894921 (I_Tot = 0.682689492137086)
n:2 - Range: [μ-2σ,μ] U [μ,μ+2σ]
 --&gt; I U I = 2*0.1359051220 = 0.2718102440 (I_Tot = 0.954499736103642)
n:3 - Range: [μ-3σ,μ] U [μ,μ+3σ]
 --&gt; I U I = 2*0.0214002339 = 0.0428004678 (I_Tot = 0.997300203936740)
n:4 - Range: [μ-4σ,μ] U [μ,μ+4σ]
 --&gt; I U I = 2*0.0013182268 = 0.0026364536 (I_Tot = 0.999936657516334)
n:5 - Range: [μ-5σ,μ] U [μ,μ+5σ]
 --&gt; I U I = 2*0.0000313846 = 0.0000627692 (I_Tot = 0.999999426696856)
n:6 - Range: [μ-6σ,μ] U [μ,μ+6σ]
 --&gt; I U I = 2*0.0000002857 = 0.0000005713 (I_Tot = 0.999999998026825)
n:7 - Range: [μ-7σ,μ] U [μ,μ+7σ]
 --&gt; I U I = 2*0.0000000010 = 0.0000000020 (I_Tot = 0.999999999997440)
</pre></div>
</div>
</div>
</div>
<p>Formatting the output:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(n\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(x\in \mathfrak{R}_A)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(x\in \mathfrak{R}_B)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(P(x\in \mathfrak{R}_C)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>34.1%</p></td>
<td><p>68.2%</p></td>
<td><p>68.27%</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>13.6%</p></td>
<td><p>27.2%</p></td>
<td><p>95.45%</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>2.14%</p></td>
<td><p>4.3%</p></td>
<td><p>99.73%</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>0.13%</p></td>
<td><p>0.26%</p></td>
<td><p>99.994%</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>0.003%</p></td>
<td><p>0.006%</p></td>
<td><p>99.99994%</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>0.00003%</p></td>
<td><p>0.00006</p></td>
<td><p>99.9999998%</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>0.00000010%</p></td>
<td><p>0.00000020</p></td>
<td><p>99.9999999997%</p></td>
</tr>
</tbody>
</table>
<p>where the ranges in the probabilities are defined as:</p>
<p><span class="math notranslate nohighlight">\(\mathfrak{R}_A: x \in \left[\mu - n \sigma,\,\mu - (n-1) \sigma\right]\)</span>
<span class="math notranslate nohighlight">\(\mathfrak{R}_B: x \in \left[\mu-n\sigma,\,\mu-(n-1)\sigma\right] \cup \left[\mu+(n-1)\sigma,\,\mu+n\sigma\right]\)</span><br />
<span class="math notranslate nohighlight">\(\mathfrak{R}_C: x \in \left[\mu-n\sigma,\,\mu+n\sigma\right]\)</span></p>
<p>They look cool, but what’s the meaning of these?</p>
<ul>
<li><p>Let’s start with the last range, <span class="math notranslate nohighlight">\(P(x \in \mathfrak{R}_C)\)</span>: It is the probability that an event randomly choosen from the given distribution will be within (upto) the <span class="math notranslate nohighlight">\([\mu-n\sigma,\mu+n\sigma]\)</span> range.</p>
<p>For example, if we randomly draw a number from a Gaussian distribution with <span class="math notranslate nohighlight">\(\mu = 5\)</span> and <span class="math notranslate nohighlight">\(\sigma = 2.5\)</span>, the probability that the number we get will be in between -2.5 and 12.5 is 99.73% <span class="math notranslate nohighlight">\((n=3:\;(\mu-3\sigma = 5-3\times2.5=-2.5) \quad\&amp;\quad(\mu+3\sigma = 5+3\times2.5=12.5) )\)</span>.</p>
</li>
<li><p>First range, <span class="math notranslate nohighlight">\(P(x \in \mathfrak{R}_A)\)</span> lists the exclusive probability that the randomly drawn number will belong to the exclusive interval between <span class="math notranslate nohighlight">\(\mu - n \sigma\)</span> and <span class="math notranslate nohighlight">\(\mu - (n-1) \sigma\)</span>.</p>
<p><em>(As the distribution is symmetric (even) around <span class="math notranslate nohighlight">\(\mu\)</span>, this is also equal to the probability of the number being from the <span class="math notranslate nohighlight">\([\mu+(n-1)\sigma,\,\mu+n\sigma]\)</span> interval)</em></p>
<p>So, for example, if we once again consider <span class="math notranslate nohighlight">\(n=3\)</span>, the probability that a randomly drawn number from our distribution to be from <span class="math notranslate nohighlight">\([5-3\times 2.5,\,5-2\times 2.5]=[-2.5,\,0]\)</span> <em>(or equivalently from <span class="math notranslate nohighlight">\([5+2\times 2.5,\,5+3\times 2.5]= [10,\,12.5]\)</span>)</em> is 2.14%</p>
</li>
<li><p>And finally, the 2nd column gives the probability that the randomly chosen value will be either to the left or to the right of the mean by <span class="math notranslate nohighlight">\((n-1)\sigma\)</span> to <span class="math notranslate nohighlight">\(n\sigma\)</span>.</p>
<p>In our example (<span class="math notranslate nohighlight">\(n=3\)</span>) this means that, the randomly chosen value will be either between <span class="math notranslate nohighlight">\(5-7.5\dotsc5-5 = -2.5\dotsc0\)</span> <strong>or</strong> between <span class="math notranslate nohighlight">\(5+5\dotsc5+7.5=10\dotsc12.5\)</span> with a probability of 4.3%</p>
</li>
</ul>
<p><img alt="6sigmas.png" src="_images/6sigmas.png" />
(Experimental Design - From User Studies to Psychophysics by Cunningham &amp; Wallraven)</p>
<p>But, really, what does this mean? Take nanotechnology lab for example, let’s assume they are producing very refined nanotubes on demand. Due to the comptetition, their profit margin is really cut and it means that they really have to be careful. They have received an order of 1μg C(9,9) armchair type carbon nanotubes. Due to their production methods, there is a chance that some other types of nanotubes (like C(10,10) or C(9,8), etc..) can exist in the process, reducing the pureness. As long as they are working in the 2σ range, it’s OK. There is a 68% chance that the outcome will be within the desired pureness. The erroneous nanotubes can be C(9,8) (lower in diameter) or C(10,10) (greater in diameter), but as long as their ratio is 13.6% it’s also acceptable. But what is not acceptable is when the radii are greated than C(10,10)s (then they clog the vessel) or lower than C(9,8) (where they slip through the pores in the material). So this means that a 2σ precision/quality is required.</p>
<p>In another example: consider the following news back from the days when the evasive Higgs’ Boson was found. They were “99.99994%” sure (or “5 sigmas” as it was declared in the official announcement):</p>
<p><a class="reference external" href="https://cds.cern.ch/record/1459454?ln=en">“We observe in our data clear signs of a new particle, at the level of 5 sigma, in the mass region around 126 GeV.”</a></p>
<p>(You can also check <a class="reference external" href="http://www.physics.org/article-questions.asp?id=103">What does the 5 sigma mean?</a>)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="a-code-of-our-own-deriving-the-sigma-distribution-ratios-stochastically">
<h1>A code of our own: Deriving the <span class="math notranslate nohighlight">\(\sigma\)</span> distribution ratios stochastically<a class="headerlink" href="#a-code-of-our-own-deriving-the-sigma-distribution-ratios-stochastically" title="Permalink to this headline">¶</a></h1>
<p>One of the questions in the final exam of (20191’s) FIZ353 : Numerical Analysis course was:</p>
<p><em>Show that when N is sufficiently great (~10000), for an ideal Gaussian distribution the number of the elements within the  <span class="math notranslate nohighlight">\(\sigma\)</span> neighborhood of the mean constitute around 68.2% of the total; those lying within <span class="math notranslate nohighlight">\(\sigma\)</span> and  <span class="math notranslate nohighlight">\(2\sigma\)</span> constitute 13.6% of the total and between <span class="math notranslate nohighlight">\(2\sigma\)</span> and  <span class="math notranslate nohighlight">\(3\sigma\)</span> amounts to 2.1% of the total.</em></p>
<p>In the above, we’ve derived these numbers/ratios via integration but we can also do it stochastically, i.e., by drawing random numbers from a Gaussian distribution and then analyzing their range frequencies, so let’s do that!</p>
<ol class="simple">
<li><p>Define a Gaussian distribution by specifying <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>.</p></li>
<li><p>Draw <span class="math notranslate nohighlight">\(N\)</span> random values to build a set.</p></li>
<li><p>Calculate the mean and standard deviation of this set (they will be close to but not exactly the same as the ones we specified in step 1 – why is that?)</p></li>
<li><p>Count the number of elements (<span class="math notranslate nohighlight">\(n_i\)</span>) in the set for each one of the intervals mean – n x stddev (and also <span class="math notranslate nohighlight">\(\mu\)</span> – <span class="math notranslate nohighlight">\(n\times\sigma\)</span> - which one of these two is better?).</p></li>
<li><p>Divide <span class="math notranslate nohighlight">\(\{n_i\}\)</span> to <span class="math notranslate nohighlight">\(N\)</span> to find the probabilities – multiply them by 100 if you want to write them in ‘%’ notation.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Fixing the seed so that the results are repeatable</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">371</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">gauss_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gauss_data</span><span class="p">)</span>
<span class="n">stddev</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">gauss_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Calculated mean: </span><span class="si">%.5f</span><span class="s2"> | std dev: </span><span class="si">%.5f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">stddev</span><span class="p">))</span>

<span class="n">RANGE</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">RANGE</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[</span><span class="si">%2d</span><span class="s2">*sigma+mu,</span><span class="si">%2d</span><span class="s2">*sigma+mu) &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">RANGE</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">RANGE</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">lim1</span> <span class="o">=</span> <span class="n">mu</span><span class="o">+</span><span class="n">RANGE</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">sigma</span><span class="p">;</span>
    <span class="n">lim2</span> <span class="o">=</span> <span class="n">mu</span><span class="o">+</span><span class="n">RANGE</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sigma</span><span class="p">;</span>
    <span class="n">lim1B</span> <span class="o">=</span> <span class="n">mean</span><span class="o">+</span><span class="n">RANGE</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">stddev</span><span class="p">;</span>
    <span class="n">lim2B</span> <span class="o">=</span> <span class="n">mean</span><span class="o">+</span><span class="n">RANGE</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">stddev</span><span class="p">;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[</span><span class="si">%8.4f</span><span class="s2">,</span><span class="si">%8.4f</span><span class="s2">]&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">lim1</span><span class="p">,</span><span class="n">lim2</span><span class="p">))</span>
    <span class="n">n_i</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">gauss_data</span><span class="o">&gt;=</span><span class="n">lim1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gauss_data</span><span class="o">&lt;</span><span class="n">lim2</span><span class="p">))</span>
    <span class="n">n_iB</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">gauss_data</span><span class="o">&gt;=</span><span class="n">lim1B</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">gauss_data</span><span class="o">&lt;</span><span class="n">lim2B</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">        using (μ,σ): </span><span class="si">%6.3f</span><span class="s2"> (</span><span class="si">%.3f%%</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n_i</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="n">n_i</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">using (mean,stddev): </span><span class="si">%6.3f</span><span class="s2"> (</span><span class="si">%.3f%%</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n_iB</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="n">n_iB</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calculated mean: 50.07108 | std dev: 6.97154

[-3*sigma+mu,-2*sigma+mu) [ 29.0000, 36.0000]
	        using (μ,σ):  0.022 (2.170%)
	using (mean,stddev):  0.023 (2.260%)
---------------------------------------------
[-2*sigma+mu,-1*sigma+mu) [ 36.0000, 43.0000]
	        using (μ,σ):  0.133 (13.280%)
	using (mean,stddev):  0.135 (13.510%)
---------------------------------------------
[-1*sigma+mu, 1*sigma+mu) [ 43.0000, 57.0000]
	        using (μ,σ):  0.686 (68.610%)
	using (mean,stddev):  0.684 (68.420%)
---------------------------------------------
[ 1*sigma+mu, 2*sigma+mu) [ 57.0000, 64.0000]
	        using (μ,σ):  0.136 (13.600%)
	using (mean,stddev):  0.135 (13.480%)
---------------------------------------------
[ 2*sigma+mu, 3*sigma+mu) [ 64.0000, 71.0000]
	        using (μ,σ):  0.020 (1.980%)
	using (mean,stddev):  0.020 (1.970%)
---------------------------------------------
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="poisson-distribution">
<h1>Poisson Distribution<a class="headerlink" href="#poisson-distribution" title="Permalink to this headline">¶</a></h1>
<p>When we took the limit of the number of possible outcomes through a binomial decision tree (i.e., drastically increased the levels of the Galton machine), we arrived to Gaussian (normal) distribution. We mentioned that, the Gaussian distribution was the way nature worked around: there is a most likely defined average (mean) and then the further you moved away from this average, the less probable you’d encounter a specimen from that region. For instance: let the average height of adult Turkish females be 1.63m<a class="reference external" href="http://www.cumhuriyet.com.tr/haber/iste-turkiyedeki-ortalama-erkek-ve-kadin-boyu-864030">*</a>. This means that we’ll likely find many people between 1.60m - 1.65m alas not that many with heights around 1.30m. Or if the average of the grades in regard to an exam is 45% – we don’t expect many people with a grade higher than 80%. These are all normally expected outcomes and it comes to us naturally.</p>
<p>But there are cases when the probability of something occuring is very low, like a plane crashing or a harddisk recently out of the factory to malfunction or a radioactive element’s decay within a short time margin. For these kinds of situations we once again begin from binomial distribution but this time we take the probability to be very low such that aside from the <span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span>, we now also have the limit: <span class="math notranslate nohighlight">\(p\rightarrow0\)</span>). Since the first is very high and the latter very low, it is sufficient that their product is some finit number (which we’ll refer to as <span class="math notranslate nohighlight">\(\lambda\; (np \rightarrow \lambda &gt; 0\)</span>).</p>
<p>For our derivation, let’s start once again by this wonderful intution to take the limit of <span class="math notranslate nohighlight">\(y=(1-p)^{1/p}\)</span> as <span class="math notranslate nohighlight">\(p\rightarrow 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\lim_{p\rightarrow0}{\ln y} = \lim_{p\rightarrow0}{\frac{\ln (1-p)}{p}}=\lim_{p\rightarrow0}{\frac{-1/(1-p)}{1}}=-1\]</div>
<p>where we applied <a class="reference external" href="https://en.wikipedia.org/wiki/L%27H%C3%B4pital%27s_rule">L’Hospital’s Rule</a> to evaluate the limit. Now that we know <span class="math notranslate nohighlight">\(\lim_{p\rightarrow0}{\ln y} = -1\)</span>, we can exponentiate both sides to yield <span class="math notranslate nohighlight">\(\lim_{p\rightarrow0}{y}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\lim_{p\rightarrow0}{y}=\lim_{p\rightarrow0}{(1-p)^{1/p}} = e^{-1}\]</div>
<p>Why we did these? We’ll see in a minute (I really hate this “pre-derivations out of nowhere” 8P).</p>
<p>Now we all know that, the probability of an outcome with a probability <span class="math notranslate nohighlight">\(p\)</span>, happening <span class="math notranslate nohighlight">\(k\)</span> times out of <span class="math notranslate nohighlight">\(n\)</span> drawings/choosings is given by the binomial distributions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}P(k) &amp;= C(n,k)\, p^k (1-p)^{n-k} = \frac{n!}{k!\left(n-k\right)!} p^k (1-p)^{n-k}\\&amp;= \frac{n(n-1)\dotsc(n-k+1)}{k!} \frac{p^k(1-p)^n}{(1-p)^k}\\
&amp;=\frac{(np)^k}{k!}\left(\frac{n-1}{n}\right)\dotsc \left(\frac{n-k+1}{n}\right)\frac{\left[(1-p)^{1/p}\right]^{np}}{(1-p)^k}
\end{align*}\end{split}\]</div>
<p>As <span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span>:</p>
<div class="math notranslate nohighlight">
\[\lim_{n\rightarrow\infty}{\frac{n-\#}{n}}=1\]</div>
<p>where <span class="math notranslate nohighlight">\(\#\)</span> is a finite number.</p>
<p>Also, as <span class="math notranslate nohighlight">\(p\rightarrow0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\lim_{p\rightarrow0}{\frac{1}{(1-p)^k}} = \frac{1}{1^k} = 1\]</div>
<p>So taking the limit of <span class="math notranslate nohighlight">\(P(k)\)</span> and also substituting <span class="math notranslate nohighlight">\(\lambda = np\)</span> in this limit, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\lim_{n\rightarrow\infty\\p\rightarrow0}{P(k)}=\frac{\lambda^k \left(e^{-1}\right)^\lambda}{k!}=\frac{\lambda^k e^{-\lambda}}{k!}\end{split}\]</div>
<p>where we used the identity <span class="math notranslate nohighlight">\(\lim_{p\rightarrow0}{(1-p)^{1/p}} = e^{-1}\)</span> we derived in the beginning of this section.</p>
<p>This probability distribution function:</p>
<div class="math notranslate nohighlight">
\[P(k) = \frac{\lambda^k e^{-\lambda}}{k!}\]</div>
<p>that describes the probability of a very-low chance outcome (<span class="math notranslate nohighlight">\(p\rightarrow0\)</span>) happening k times out of a very high (practically infinite) number of drawings/tries/choosings (<span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span>) is called as the <strong>Poisson Distribution</strong>.</p>
<section id="assignment-hw-mean-and-variance-of-poisson-distribution">
<h2>Assignment / HW : mean and variance of Poisson distribution<a class="headerlink" href="#assignment-hw-mean-and-variance-of-poisson-distribution" title="Permalink to this headline">¶</a></h2>
<p>Show that the mean value and the variance of a Poisson distribution, characterized by a <span class="math notranslate nohighlight">\(\lambda\)</span> parameter, are as follows:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu = \lambda\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma^2 = \lambda\)</span></p></li>
</ul>
</section>
<section id="example-airplane-accidents">
<h2>Example: Airplane accidents<a class="headerlink" href="#example-airplane-accidents" title="Permalink to this headline">¶</a></h2>
<p>On every <span class="math notranslate nohighlight">\(10^{12}\)</span> flight miles, an accident occurs on average.</p>
<p>What is the probability of an accident happening up to:<br />
a) <span class="math notranslate nohighlight">\(10^9\)</span> flight miles?<br />
b) <span class="math notranslate nohighlight">\(10^{13}\)</span> flight miles?</p>
<p><strong>Solution</strong><br />
<span class="math notranslate nohighlight">\(p = 1/10^{12} = 10^{-12}\)</span> (hence, very very low)</p>
<p>a) <span class="math notranslate nohighlight">\(n = 10^9\)</span> (very very high)</p>
<div class="math notranslate nohighlight">
\[\lambda = n\,p=10^9.\,10^{-12} = 10^{-3}\]</div>
<p>probability that no accident happens: <span class="math notranslate nohighlight">\(k = 0\)</span> (k: # of accidents)</p>
<div class="math notranslate nohighlight">
\[P(k=0) = \frac{e^{-\lambda}\lambda^k}{k!} = \frac{\left(e^{-\left(10^{-3}\right)}\right)\left(10^{-3}\right)^0}{0!} = 0.999\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.999000499833375
</pre></div>
</div>
</div>
</div>
<p>That was the probability that no accident occurs. Thus, the probability that -at least- an accident occurs will be:<br />
1 - (probability that no accident occurs)<br />
= 1 - 0.999000499 = 0.0009995</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">P_0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.000999500166624978
</pre></div>
</div>
</div>
</div>
<p>b)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\lambda = 10^{13}.\,10^{-12} = 10^1\\
P(k=0) = \frac{\left(e^{-\left(10\right)}\right)\left(10^{-1}\right)^0}{0!} = 0.0000454\end{split}\]</div>
<p>The probability that -at least- an accident occurs will be:<br />
1 - (probability that no accident occurs)<br />
= 1 - 0.0000454 = 0.99995</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="FIZ371_LN10_EST_Distributions_1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Distributions 1 : Discrete Distributions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="FIZ371_LN25_EST_Game_Theory.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Game Theory</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Dr. Emre S. Tasci<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>