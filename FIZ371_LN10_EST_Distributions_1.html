
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Distributions 1 : Discrete Distributions &#8212; FIZ371 - Scientific and Technical Computations Lecture Notes</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Distributions 2 : Continous Distributions" href="FIZ371_LN15_EST_Distributions_2.html" />
    <link rel="prev" title="Six Switch Puzzle" href="FIZ371_LN06_SixSwitchPuzzle_and_Parallelization.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FIZ371 - Scientific and Technical Computations Lecture Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Cover.html">
   FIZ371 - Scientific and Technical Calculations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN01_EST_Probabilities_Theory.html">
   Probabilities - Concept &amp; Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN01_EST_Probabilities_Theory_Application_WOZ.html">
   Probabilities Application: Letter Frequencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN02_EST_Probabilities.html">
   Probabilities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN08_EST_Application_Monty_Hall.html">
   Monty Hall Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="WhiteTokenOutOf2.html">
   Application White Token Out Of 2 Bags
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN06_SixSwitchPuzzle_and_Parallelization.html">
   Six Switch Puzzle
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Discrete Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN15_EST_Distributions_2.html">
   Distributions 2 : Continous Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN25_EST_Game_Theory.html">
   Game Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN28_EST_Game_Theory_PrisonnersDilemmaWithMemory.html">
   Application Prisonner's Dilemma (with Memory)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN75_EST_Gale-ShapleyAlgo.html">
   Gale-Shapley Matching Algorithm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="GaleShapleyMatching_Implementation.html">
   Gale-Shapley Algorithm Implementation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN36_EST_Information_Theory.html">
   Information Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN36_EST_Information_Theory_MessageTransmissionOverNoise.html">
   Information Theory Application
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN47_EST_CellularAutomata_GameOfLife.html">
   Cellular Automata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN80_EST_2DIsing.html">
   2D Ising Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN58_EST_ClusteringAndClassification.html">
   Clustering and Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_LN69_EST_NeuralNetworks.html">
   Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_20221_MT.html">
   2022-23 Fall Term Midterm Exam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_20221_Final.html">
   2022-23 Fall Term Final Exam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_20221_Resit.html">
   2022-23 Fall Term Resit Exam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_20231_MT_MakeUp.html">
   Midterm Resit Exam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_20231_Final.html">
   Final Exam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ371_20231_Final_Resit.html">
   Final Exam’s Resit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MinimizeOptimizeFit.html">
   Optimization, Minimization &amp; Fitting Notes &amp; Recipes
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/FIZ371_LN10_EST_Distributions_1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/FIZ371_LN10_EST_Distributions_1.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/emresururi/FIZ228/master?urlpath=tree/FIZ371_LN10_EST_Distributions_1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#distribution">
   Distribution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dice-distribution">
     Dice distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drawing-from-a-distribution-function">
     Drawing from a distribution function
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bernoulli-binomial-distribution">
   Bernoulli/Binomial Distribution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combinatrics">
     Combinatrics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#galton-machine">
     Galton Machine
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Distributions 1 : Discrete Distributions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#distribution">
   Distribution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dice-distribution">
     Dice distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drawing-from-a-distribution-function">
     Drawing from a distribution function
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bernoulli-binomial-distribution">
   Bernoulli/Binomial Distribution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combinatrics">
     Combinatrics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#galton-machine">
     Galton Machine
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="distributions-1-discrete-distributions">
<h1>Distributions 1 : Discrete Distributions<a class="headerlink" href="#distributions-1-discrete-distributions" title="Permalink to this headline">¶</a></h1>
<p><strong>FIZ371 - Scientific &amp; Technical Computations | 31/03/2020</strong></p>
<p><strong>Discrete Distributions</strong></p>
<ul>
<li><p>Dice distribution</p>
<ul class="simple">
<li><p>Fair dice</p>
<ol class="simple">
<li><p>Expected value</p></li>
<li><p>Variance</p></li>
<li><p>Standard deviation</p></li>
</ol>
</li>
<li><p>Loaded Dice</p>
<ul>
<li><p>Drawing from a distribution function</p>
<ul>
<li><p>Creating a sample list</p></li>
<li><p>Using the PDF directly</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Bernoulli / Binomial Distribution</p>
<ul class="simple">
<li><p>Combinatrics</p></li>
<li><p>Galton Machine</p></li>
</ul>
<p>[Plotting: matplotlib.pyplot.bar()]</p>
</li>
</ul>
<p>Emre S. Tasci <a class="reference external" href="mailto:emre&#46;tasci&#37;&#52;&#48;hacettepe&#46;edu&#46;tr">mailto:emre<span>&#46;</span>tasci<span>&#64;</span>hacettepe<span>&#46;</span>edu<span>&#46;</span>tr</a></p>
<section id="distribution">
<h2>Distribution<a class="headerlink" href="#distribution" title="Permalink to this headline">¶</a></h2>
<p>A distribution, or more directly, <em>a probability distribution</em> is the distribution of weights among the possible outcomes of a drawing. We will start from discrete distributions (such as dice, binomial distributions) and will move on to continous distributions (such as Gaussian, Laplace distributions).</p>
<section id="dice-distribution">
<h3>Dice distribution<a class="headerlink" href="#dice-distribution" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Fair dice</strong></p></li>
</ul>
<p>Let’s start using a fair, 6-sided dice. If it is fair, then it means that the probability for any of the 6 possible outcomes must be the same. And as the sum of the probabilities must be equal to 1, we have:</p>
<div class="math notranslate nohighlight">
\[p(x=1) = p(x=2) = ... =p(x=6),\quad\sum^{6}_{i=1}{p(x=i)}=1\,\Rightarrow p(x=i) = \frac{1}{6}\quad(i \in [1,6])\]</div>
<p>For which the graph of our probability distribution function (PDF) looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fair_pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">6</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">fair_pdf</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">],[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;1/12&quot;</span><span class="p">,</span><span class="s2">&quot;1/6&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PDF of a fair 6-sided dice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/FIZ371_LN10_EST_Distributions_1_3_0.png" src="_images/FIZ371_LN10_EST_Distributions_1_3_0.png" />
</div>
</div>
<p>These kind of probability distribution functions (PDFs) where every possible outcome has equal probability are called as <strong>Uniform Distributions</strong>.</p>
<p>1. Expected (Average) Value <span class="math notranslate nohighlight">\(\left(\mu,\left&lt;x\right&gt;, E[x]\right)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mu = \sum_{x_i}{x_i\cdot p(x_i)}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">fair_pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">6</span>
<span class="n">mean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">fair_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Expected value: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">mean</span>)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Expected value: 3.500
</pre></div>
</div>
</div>
</div>
<p>2. Variance (<span class="math notranslate nohighlight">\(\sigma^2\)</span>):</p>
<div class="math notranslate nohighlight">
\[\sigma^2 = \sum_{x_i}{x_i^2 p(x_i) - \mu^2}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">fair_pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">6</span>
<span class="n">mean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">fair_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">var</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">var</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span><span class="n">fair_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">var</span> <span class="o">=</span> <span class="n">var</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Expected value: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">mean</span>)
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Variance: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">var</span>)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Expected value: 3.500
Variance: 2.917
</pre></div>
</div>
</div>
</div>
<p>3. Standard Deviation (<span class="math notranslate nohighlight">\(\sigma\)</span>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\sigma&amp;=\sqrt{\sigma^2}\\
\sigma &amp;= \sqrt{\left&lt;x^2\right&gt; - \left&lt;x\right&gt;^2}\\
&amp;=\sqrt{\sum_{i}{p_i \left(x_i - \mu\right)^2}}
\end{align*}\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">fair_pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">6</span>
<span class="n">mean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">fair_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">var</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">var</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span><span class="n">fair_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">var</span> <span class="o">=</span> <span class="n">var</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>

<span class="n">std</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">std</span> <span class="o">+=</span> <span class="n">fair_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Expected value: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">mean</span>)
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Variance: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">var</span>)
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Standard Deviation: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">std</span>)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Expected value: 3.500
Variance: 2.917
Standard Deviation: 1.708
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Loaded Dice</strong></p></li>
</ul>
<p>Now consider that we have a “loaded dice” such that its PDF is given by:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">loaded_pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">loaded_pdf</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">],[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;1/8&quot;</span><span class="p">,</span><span class="s2">&quot;1/4&quot;</span><span class="p">,</span><span class="s2">&quot;3/8&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PDF of a loaded 6-sided dice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/FIZ371_LN10_EST_Distributions_1_12_0.png" src="_images/FIZ371_LN10_EST_Distributions_1_12_0.png" />
</div>
</div>
<p>Let’s calculate its properties:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">loaded_pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">])</span>

<span class="n">mean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">loaded_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">var</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">var</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span><span class="n">loaded_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">var</span> <span class="o">=</span> <span class="n">var</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>

<span class="n">std</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">std</span> <span class="o">+=</span> <span class="n">loaded_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Expected value: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">mean</span>)
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Variance: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">var</span>)
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Standard Deviation: </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">std</span>)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Expected value: 4.000
Variance: 2.250
Standard Deviation: 1.500
</pre></div>
</div>
</div>
</div>
</section>
<section id="drawing-from-a-distribution-function">
<h3>Drawing from a distribution function<a class="headerlink" href="#drawing-from-a-distribution-function" title="Permalink to this headline">¶</a></h3>
<p>We have our probability distribution function, but how do we draw from such a distribution? Looking at the distribution graph, we see that, no matter how many times we roll the dice, we’ll never get a ‘2’. Also, in theory, out of 8 rolls, we’ll get a ‘5’ three times. But the question remains: when we have the probability distribution function, how do we use to draw samples that comply with it?</p>
<p><strong>Creating a sample list</strong><br />
If the number of variables in a PDF is low like our loaded dice, we can “construct” a sample list and draw randomly (as in “uniformly”) from that list. So, for the case we have, we can define our list as:
<img alt="pdfloadeddice.png" src="_images/pdfloadeddice.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_dice_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>This list has the same probability of outcomes as that of the given distribution (e.g., there are two 3s out of a total of eight numbers, so its probability is 1/3, etc.). Thus, we can use a uniform random number generator to produce a random number between 0 and 7 and correspond it with our set (0 -&gt; “1”; 1 -&gt; “3”; 2 -&gt; “3”; … ; 7 -&gt; “6”):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Fixing the seed so that the results are repeatable</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">371</span><span class="p">)</span>

<span class="c1"># Let&#39;s draw 10 numbers</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">loaded_dice_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

<span class="c1"># Creating an empty array to store the drawn numbers</span>
<span class="n">drawn_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="c1"># Randomly pick a number in [0,7] ( =[0,8) ) </span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">rth_element</span> <span class="o">=</span> <span class="n">loaded_dice_set</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
    
    <span class="c1"># Add this to our drawn_numbers set</span>
    <span class="n">drawn_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drawn_numbers</span><span class="p">,</span><span class="n">rth_element</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">drawn_numbers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5. 3. 3. 1. 5. 5. 4. 5. 4. 3.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s calculate the frequencies of occurences:</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
    <span class="n">freqs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">drawn_numbers</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Number of occurences of </span><span class="si">%d</span><span class="s2">: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">freqs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of occurences of 1: 1
Number of occurences of 2: 0
Number of occurences of 3: 3
Number of occurences of 4: 2
Number of occurences of 5: 4
Number of occurences of 6: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># From here on, calculating the occurence probabilities are straightforward:</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">freqs</span> <span class="o">/</span> <span class="mf">10.</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="c1"># Taking out the dummy 0th entry</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

<span class="c1"># We will use the original probability dist for comparison</span>
<span class="n">probs_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">probs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">probs_real</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.1 0.  0.3 0.2 0.4 0. ]
</pre></div>
</div>
<img alt="_images/FIZ371_LN10_EST_Distributions_1_20_1.png" src="_images/FIZ371_LN10_EST_Distributions_1_20_1.png" />
</div>
</div>
<p>It doesn’t quite match that of the original distribution… Can it be due to the low number of draws we have made? Let’s up it from 10 to 10000:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Fixing the seed so that the results are repeatable</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">371</span><span class="p">)</span>

<span class="c1"># Let&#39;s draw 10000 numbers</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">loaded_dice_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

<span class="c1"># Creating an empty array to store the drawn numbers</span>
<span class="n">drawn_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="c1"># Randomly pick a number in [0,7] ( =[0,8) ) </span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">rth_element</span> <span class="o">=</span> <span class="n">loaded_dice_set</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
    
    <span class="c1"># Add this to our drawn_numbers set</span>
    <span class="n">drawn_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drawn_numbers</span><span class="p">,</span><span class="n">rth_element</span><span class="p">)</span>
    
<span class="c1"># Let&#39;s calculate the frequencies of occurences:</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
    <span class="n">freqs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">drawn_numbers</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Number of occurences of </span><span class="si">%d</span><span class="s2">: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">freqs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># From here on, calculating the occurence probabilities are straightforward:</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">freqs</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="c1"># Taking out the dummy 0th entry</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

<span class="c1"># We will use the original probability dist for comparison</span>
<span class="n">probs_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">probs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">probs_real</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of occurences of 1: 1239
Number of occurences of 2: 0
Number of occurences of 3: 2559
Number of occurences of 4: 1254
Number of occurences of 5: 3731
Number of occurences of 6: 1217
[0.1239 0.     0.2559 0.1254 0.3731 0.1217]
</pre></div>
</div>
<img alt="_images/FIZ371_LN10_EST_Distributions_1_22_1.png" src="_images/FIZ371_LN10_EST_Distributions_1_22_1.png" />
</div>
</div>
<p>Much, much better!… 8)</p>
<p><strong>Using the PDF directly</strong><br />
Most of the time, we don’t have a small number of options (in the limit, we will be talking about continous outcomes), or even rational probabilities meaning that, we are not able to construct a sample box representing the distribution precisely. In those times, we literally employ the probabilities:</p>
<ol class="simple">
<li><p>First, pick a random possible outcome</p></li>
<li><p>Then, roll a fair dice to see if it would come</p></li>
</ol>
<p>Codewise, this translates to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Fixing the seed so that the results are repeatable</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">371</span><span class="p">)</span>

<span class="c1"># The first 0 is to cover the dummy 0th value</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">])</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">drawn_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<span class="k">while</span> <span class="n">drawn_numbers</span><span class="o">.</span><span class="n">size</span><span class="o">&lt;=</span><span class="n">N</span><span class="p">:</span>
    <span class="c1"># First pick a random integer from [1,6]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
    
    <span class="c1"># It&#39;s happening probability is probs[r],</span>
    <span class="c1"># so, roll a dice, if the outcome is less than the</span>
    <span class="c1"># probability, accept it, else, reject it</span>
    <span class="k">if</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">&lt;</span><span class="n">probs</span><span class="p">[</span><span class="n">r</span><span class="p">]):</span>
        <span class="n">drawn_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drawn_numbers</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># Calculate the frequencies of occurence &amp; probabilities from the set:</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
    <span class="n">freqs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">drawn_numbers</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Number of occurences of </span><span class="si">%d</span><span class="s2">: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">freqs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    
<span class="n">probs2</span> <span class="o">=</span> <span class="n">freqs</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">probs2</span> <span class="o">=</span> <span class="n">probs2</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="c1"># Taking out the dummy 0th entry</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Calculated probabilities: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">probs2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">probs2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PDF of a loaded 6-sided dice after </span><span class="si">%d</span><span class="s2"> rolls&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of occurences of 1: 1300
Number of occurences of 2: 0
Number of occurences of 3: 2528
Number of occurences of 4: 1252
Number of occurences of 5: 3735
Number of occurences of 6: 1186

Calculated probabilities: 
 [0.13   0.     0.2528 0.1252 0.3735 0.1186]
</pre></div>
</div>
<img alt="_images/FIZ371_LN10_EST_Distributions_1_25_1.png" src="_images/FIZ371_LN10_EST_Distributions_1_25_1.png" />
</div>
</div>
</section>
</section>
<section id="bernoulli-binomial-distribution">
<h2>Bernoulli/Binomial Distribution<a class="headerlink" href="#bernoulli-binomial-distribution" title="Permalink to this headline">¶</a></h2>
<p>We will start simple: consider a draw where there is only two possible outcomes like the flipping of a coin (heads|tails), signal from a digital source (0|1), the turn taken (left|right), etc.</p>
<p>Let a flipped coin’s probability to come heads (<em>x=1</em>) be <span class="math notranslate nohighlight">\(0\le p\le1\)</span> instead of the usual <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> (i.e., not necessarily fair).</p>
<p>so the probabilities are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}P(x=1) &amp;= p\\
P(x=0) &amp;= 1-p\end{align*}\end{split}\]</div>
<p>we can combine these two equations into one such as:</p>
<div class="math notranslate nohighlight">
\[P(x) = p^x \left(1-p\right)^{1-x}\]</div>
<p>1. Mean Value:</p>
<div class="math notranslate nohighlight">
\[\mu=\left&lt;x\right&gt; = 1. p+ 0. (1-p) = p\]</div>
<p>2. Variance:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left&lt;x^2\right&gt; =1^2. p+ 0^2. (1-p) = p\\
\rightarrow \sigma^2 = \left&lt;x^2\right&gt; - \left&lt;x\right&gt;^2 = p - p^2 = p (1-p)\end{split}\]</div>
<p>If the flipping / choosing is repeated <em>n</em> times:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}P_{X_1,X_2,...,X_n}(x_1,x_2,...,x_n) &amp;= P_{X_1}(x_1). P_{X_2}(x_2)...P_{X_n}(x_n)\\
&amp;=\left[p^{x_1}\left(1-p\right)^{1-x_1}\right].
\left[p^{x_2}\left(1-p\right)^{1-x_2}\right]...
\left[p^{x_n}\left(1-p\right)^{1-x_n}\right]\\
&amp;=p^{x_1+x_2+...+x_n}\left(1-p\right)^{n-x_1-x_2-...-x_n}\\
&amp;=p^{y}\left(1-p\right)^{n-y}
\end{align*}\end{split}\]</div>
<p>where <em>y</em> is the number of 1s among <span class="math notranslate nohighlight">\(x_1,x_2,...,x_n\)</span>.</p>
<p>The probability of the chosen outcome occurring a chosen number of times (<em>k</em>):</p>
<div class="math notranslate nohighlight">
\[p\left(x=k\right) = \mathbb{C}_{n,k}\, p^k\, \left(1-p\right)^{n-k}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathbb{C}_{n,k}\)</span> (pronounced as “n choose k”, also represented by <span class="math notranslate nohighlight">\(n \choose k\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\mathbb{C}_{n,k} = \frac{\mathbb{P}_{n,k}}{k!}\]</div>
<p>and gives the possible outcomes where order is not important. <span class="math notranslate nohighlight">\(\mathbb{P_{n,k}}\)</span> is the permutation number and is used directly when the order is important <span class="math notranslate nohighlight">\(\left(\mathbb{P} = \frac{n!}{(n-k)!}\right)\)</span>.</p>
<p>Thus, <strong>Binomial Distribution</strong> is defined as the <u>probability of an outcome between two possible options <em>k</em> times in a drawing of <em>n</em> times</u>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}P(n,k) &amp;= \mathbb{C}_{n,k}\, p^k\, \left(1-p\right)^{n-k}\\
&amp;=\frac{n!}{k!\left(n-k\right)!}\,p^k\, \left(1-p\right)^{n-k}\end{align*}\end{split}\]</div>
<section id="combinatrics">
<h3>Combinatrics<a class="headerlink" href="#combinatrics" title="Permalink to this headline">¶</a></h3>
<p>Let’s calculate a couple of <span class="math notranslate nohighlight">\(\mathbb{C}_{n,k}\)</span> for various <em>n &amp; k</em> values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># comb() is the &quot;n choose k&quot; function</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C(</span><span class="si">%d</span><span class="s2">,</span><span class="si">%d</span><span class="s2">): </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C(0,0): 1 
C(1,0): 1 C(1,1): 1 
C(2,0): 1 C(2,1): 2 C(2,2): 1 
C(3,0): 1 C(3,1): 3 C(3,2): 3 C(3,3): 1 
C(4,0): 1 C(4,1): 4 C(4,2): 6 C(4,3): 4 C(4,4): 1 
</pre></div>
</div>
</div>
</div>
<p>A pattern is emerging! Let’s output only the coefficients and distribute them evenly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">kstring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">kstring</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot; &quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">kstring</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                             1                              
                            1 1                             
                           1 2 1                            
                          1 3 3 1                           
                         1 4 6 4 1                          
</pre></div>
</div>
</div>
</div>
<p>We have re-derived the <a class="reference external" href="https://en.wikipedia.org/wiki/Pascal%27s_triangle">Pascal’s Triangle</a>!</p>
<p>(Pay attention that the first row is <span class="math notranslate nohighlight">\(n = 0\)</span> and the first column is <span class="math notranslate nohighlight">\(k=0\)</span>!)</p>
<p>Pascal’s triangle has many applications. For example, in our combinatrix, it gives the possible combinations from n-elements into k-element sets, with the order not being important, e.g.:<br />
<code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">3</span> <span class="pre">:</span> <span class="pre">{a,b,c}</span> <span class="pre">k</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">:</span> <span class="pre">{a,b},</span> <span class="pre">{b,c},</span> <span class="pre">{a,c}</span> <span class="pre">==&gt;</span> <span class="pre">C(3,2)</span> <span class="pre">=</span> <span class="pre">3!/[2!(3-2)!]</span> <span class="pre">=</span> <span class="pre">3</span></code></p>
<p>On the contrary, if the order is important (e.g., <span class="math notranslate nohighlight">\(\{a,b\}\ne{b,a}\)</span>), then we need to use the permutation operator, e.g.:
<code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">3</span> <span class="pre">:</span> <span class="pre">{a,b,c}</span> <span class="pre">k</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">:</span> <span class="pre">{a,b},</span> <span class="pre">{b,a},</span> <span class="pre">{b,c},</span> <span class="pre">{c,b},</span> <span class="pre">{a,c},</span> <span class="pre">{c,a}</span> <span class="pre">==&gt;</span> <span class="pre">P(3,2)</span> <span class="pre">=</span> <span class="pre">3!/(3-2)!</span> <span class="pre">=</span> <span class="pre">6</span></code></p>
</section>
<section id="galton-machine">
<h3>Galton Machine<a class="headerlink" href="#galton-machine" title="Permalink to this headline">¶</a></h3>
<p>A Galton machine is made by arranging nails in diagonals on a vertical board:
<img alt="GaltonBoard.png" src="_images/GaltonBoard.png" /><br />
Image from <a class="reference external" href="https://en.wikipedia.org/wiki/Bean_machine#/media/File:GaltonBoard.png">Wikipedia</a></p>
<p>Balls are dropped from the top, thus at each pin they hit, there is an equal chance that they will scatter towards left or right. In the next pin they once again have a ½ chance to go towards left or right and this accumulates. So the probabilities for the first levels can be plotted as:</p>
<p><img alt="GaltonProbabilities.png" src="_images/GaltonProbabilities.png" /></p>
<p>For example, to get the left-most pin, the ball must go towards left 4 times (left-&gt;left-&gt;left-&gt;left), making the total probability of getting there <span class="math notranslate nohighlight">\(\frac{1}{16}\)</span>. Or, to get to the middle pin in the center of the 2nd level, it can follow one of the two-ways: either making a left-&gt;right, or making a right-&gt;left, thus making its cumulative probability to be there the sum of these possibilities, i.e., <span class="math notranslate nohighlight">\(\frac{1}{4}+ \frac{1}{4} = \frac{2}{4}= \frac{1}{2}\)</span>.</p>
<p>Now, let’s consult Pascal’s triangle once again, but this time, let’s normalize each row, such that every row’s sum is equal to 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span>
<span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">kstring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">sum_of_the_n_th_row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">sum_of_the_n_th_row</span> <span class="o">+=</span> <span class="p">(</span><span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">kstring</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">str</span>(Fraction(comb(n,k)/sum_of_the_n_th_row))+&quot;  &quot;
    <span class="nb">print</span><span class="p">(</span><span class="n">kstring</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            1                               
                         1/2  1/2                           
                      1/4  1/2  1/4                         
                    1/8  3/8  3/8  1/8                      
                1/16  1/4  3/8  1/4  1/16                   
</pre></div>
</div>
</div>
</div>
<p>… which are exactly our calculated probabilities above!</p>
<p>Let’s implement a Galton machine simulator – we’re not going to use any of the probabilities calculated above. We will simply send each ball, one by one, and randomly pick left/right at each nail.</p>
<p>So, here is the algorithm of the things we’re going to implement:
0. Define number of levels (n) and number of balls (N).</p>
<ol class="simple">
<li><p>Set the initial coordinate(box) of each ball to 0 (leftmost box).</p></li>
<li><p>At every level, randomly pick left or right:</p>
<ul class="simple">
<li><p>If it is left, keep the coordinate.</p></li>
<li><p>If it is right, increase the coordinate by 1.</p></li>
</ul>
</li>
<li><p>Record the final coordinate(box) of the ball by increasing that box’ count by 1.</p></li>
<li><p>Go to 1 until all balls are processed.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Fixing the seed so that the results are repeatable</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">371</span><span class="p">)</span>

<span class="c1"># Number of levels</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># this means that we&#39;re going to have (n+1) boxes</span>

<span class="c1"># Number of balls</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Initialize the boxes (numbered from 0 to n)</span>
<span class="n">arr_boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Loop over the balls</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># print(direction,end=&quot; &quot;)</span>
        <span class="n">position</span> <span class="o">+=</span> <span class="n">direction</span>

    <span class="c1"># if it goes left everytime, then the position</span>
    <span class="c1"># would be: 0 which is the leftmost box: 0</span>
        
    <span class="c1"># if it goes right everytime, then the position</span>
    <span class="c1"># would be: +n which is the rightmost box: #n</span>
    <span class="c1"># print(str(position))</span>
    <span class="n">arr_boxes</span><span class="p">[</span><span class="n">position</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation results:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr_boxes</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Let&#39;s compare it with the direct Pascal&#39;s triangle results:</span>
<span class="n">pascal_triangle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">pascal_triangle</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">=</span> <span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">kk</span><span class="p">)</span>
<span class="c1">#print(pascal_triangle)</span>
<span class="n">pascal_triangle</span> <span class="o">=</span> <span class="n">pascal_triangle</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pascal_triangle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pascal&#39;s Triangle:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pascal_triangle</span><span class="p">)</span>

<span class="c1"># While we&#39;re at it, let&#39;s also plot the probabilities by</span>
<span class="c1"># dividing the number of balls in each box to the tall # of balls:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">arr_boxes</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># and project upon it the values from Pascal&#39;s triangle:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">pascal_triangle</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simulation results:
[0.061  0.2525 0.3807 0.2423 0.0635]

Pascal&#39;s Triangle:
[0.0625 0.25   0.375  0.25   0.0625]
</pre></div>
</div>
<img alt="_images/FIZ371_LN10_EST_Distributions_1_39_1.png" src="_images/FIZ371_LN10_EST_Distributions_1_39_1.png" />
</div>
</div>
<p>In our next lecture, we’ll increase the number of balls and also will take the number of levels -almost- to infinity and then we’ll be dealing with continous distributions!</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="FIZ371_LN06_SixSwitchPuzzle_and_Parallelization.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Six Switch Puzzle</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="FIZ371_LN15_EST_Distributions_2.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Distributions 2 : Continous Distributions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Dr. Emre S. Tasci<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>